# e2e - エンドツーエンドテスト

## 概要
実際のブラウザ環境でChrome拡張機能の完全な動作フローをテストするエンドツーエンドテストを管理します。ユーザーの実際の操作をシミュレートして、拡張機能全体の動作を検証します。

## 現在の状況
現在、このディレクトリにはテストファイルが含まれていませんが、将来のE2Eテスト実装に備えて構造を準備しています。

## 計画されているテストファイル
- `popup.test.js`: ポップアップUIの操作テスト
- `sidepanel.test.js`: サイドパネルの開閉と検索機能テスト
- `contentscript.test.js`: GitHubページでのボタン表示と操作テスト
- `search-flow.test.js`: 検索フロー全体のエンドツーエンドテスト
- `keyboard-shortcuts.test.js`: キーボードショートカットの動作テスト

## 使用予定技術
```bash
# 推奨テストフレームワーク
npm install --save-dev puppeteer
npm install --save-dev jest-puppeteer
npm install --save-dev @types/puppeteer

# 実行方法（将来）
npm run test:e2e
```

## 依存関係
- 内部依存: Chrome拡張機能全体、manifest.json、全スクリプトファイル
- 外部依存: Puppeteer, Jest, Chrome/Chromium ブラウザ
- webextension-toolbox: ビルドされた拡張機能パッケージ

## 設定・権限
- Chrome/Chromiumブラウザのインストールが必要
- 拡張機能の開発者モードでの読み込み権限
- インターネット接続（API呼び出しテスト用）
- ファイルシステムアクセス権限

## クロスブラウザ対応
- Chrome: Puppeteerを使用したテスト
- Firefox: Playwright または WebDriver使用予定
- Edge: Puppeteer Edge サポート使用予定
- Safari: 将来的にWebKit対応検討

## エラーハンドリング
- ブラウザ起動失敗時の処理
- 拡張機能読み込み失敗時の処理
- ページ読み込みタイムアウトの処理
- 要素が見つからない場合の処理

## 計画されているテストシナリオ

### popup.test.js
- ポップアップの表示確認
- 検索フォームの入力と送信
- 検索結果の表示確認
- エラー状態の表示確認

### sidepanel.test.js
- サイドパネルの開閉動作
- 検索機能の動作確認
- 結果表示の確認
- レスポンシブデザインの確認

### contentscript.test.js
- GitHubページでのボタン表示
- ボタンクリック時の動作
- ページ遷移時の動作継続
- 複数タブでの動作確認

### search-flow.test.js
- 検索クエリ入力から結果表示までの完全フロー
- API呼び出しとレスポンス処理
- エラーケースの処理
- パフォーマンス測定

### keyboard-shortcuts.test.js
- Ctrl+Shift+Sショートカットの動作
- フォーカス状態の管理
- 他のショートカットとの競合確認

## 拡張・カスタマイズ
- 新しいE2Eテストシナリオの追加
- 視覚的回帰テストの実装
- パフォーマンステストの追加
- アクセシビリティテストの実装
- CI/CDパイプラインとの統合

## 実装ガイドライン
- テストは独立して実行可能であること
- テスト間でのデータ共有を避けること
- 適切なセットアップとクリーンアップを実装すること
- 実際のユーザー操作をシミュレートすること
- テスト実行時間を最適化すること

## 注意事項
- E2Eテストは現在実装されていません
- 実装前にテスト戦略の詳細な計画が必要です
- ブラウザ環境の準備が必要です
- テスト実行時間が長くなる可能性があります
- CI環境でのヘッドレスブラウザ設定が必要です